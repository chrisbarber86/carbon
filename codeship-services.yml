storybook-builder:
  build:
    image: carbon/storybook
    dockerfile: Dockerfile-story
  cached: true
  volumes:
    - ./output:/usr/src/app/storybook-static

storybook:
  image: nginx:stable
  cached: true
  depends_on:
    - storybook-builder
  volumes:
    - ./output:/usr/share/nginx/html

cypress:
  build:
    image: carbon/carbon_cypress
    dockerfile: Dockerfile-cypress
  cached: true
  environment:
    CYPRESS_baseUrl: http://storybook/
  encrypted_env_file:
    - env.encrypted
  depends_on:
    - storybook
